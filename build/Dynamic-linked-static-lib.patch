--- tools/ccopts.sh.orig	2017-07-11 01:21:48.000000000 -0400
+++ tools/ccopts.sh	2018-01-03 02:46:02.958592000 -0500
@@ -159,6 +159,7 @@
 # checking if this is set.
 
 HASDYNLOAD=0
+DISABLE_AUTODETECT=1
 case $OSNAME in
 	'Darwin'|'Linux'|'FreeBSD')
 		HASDYNLOAD=1 ;;
@@ -204,7 +205,7 @@
 		CCARGS="$CCARGS -DNCIPHER_PKCS11" ;
 	fi
 fi
-if [ -f /usr/include/zlib.h ] ; then
+if [ -f /usr/include/zlib.h -a 0 = 3 ] ; then
 	echo "  (Enabling use of system zlib)." >&2 ;
 	CCARGS="$CCARGS -DHAS_ZLIB" ;
 fi
@@ -302,7 +303,6 @@
 # of large-displacement jumps, so if you're tuning the code for size/speed
 # you can try -fpic to see if you get any improvement.
 
-if [ $# -eq 2 ] ; then
 	case $OSNAME in
 		'Darwin')
 			CCARGS="$CCARGS -fPIC -fno-common" ;;
@@ -329,7 +329,6 @@
 		*)
 			CCARGS="$CCARGS -fPIC" ;;
 	esac ;
-fi
 
 # Conversely, if we're building a static lib and the system requires it, set
 # up static lib-specific options.
@@ -643,9 +642,9 @@
 # '--param=ssp-buffer-size=4' (the default size is 8), but this isn't
 # necessary for cryptlib since it doesn't allocate any 4-byte buffers.
 
-if [ "$GCC_VER" -ge 49 ] ; then
+if [ "$GCC_VER" -ge 49 -a 1 = 3 ] ; then
 	CCARGS="$CCARGS -fstack-protector-strong -D_FORTIFY_SOURCE=2" ;
-elif [ "$GCC_VER" -ge 42 ] ; then
+elif [ "$GCC_VER" -ge 42 -a 1 = 3 ] ; then
 	if [ "$($CC -fstack-protector -S -o /dev/null -xc /dev/null 2>&1 | grep -c "unrecog")" -eq 0 ] ; then
 		CCARGS="$CCARGS -fstack-protector" ;
 	fi ;
